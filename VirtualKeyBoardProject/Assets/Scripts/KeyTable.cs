using System;
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.Apple.ReplayKit;
using UnityEngine.UI;
using UnityEngine.Windows;


public class KeyData
{
    public char DefaultKey;
    public char ShiftKey;
    public char KorKey;
    public char KorShiftKey;
}
public class KeyTable : MonoBehaviour
{
    public static KeyTable Data = null;
    private void Awake()
    {
        if (Data == null) //instance∞° null. ¡Ô, Ω√Ω∫≈€ªÛø° ¡∏¿Á«œ∞Ì ¿÷¡ˆ æ ¿ª∂ß
        {
            Data = this; //≥ª¿⁄Ω≈¿ª instance∑Œ ≥÷æÓ¡›¥œ¥Ÿ.
            DontDestroyOnLoad(gameObject); //OnLoad(æ¿¿Ã ∑ŒµÂ µ«æ˙¿ª∂ß) ¿⁄Ω≈¿ª ∆ƒ±´«œ¡ˆ æ ∞Ì ¿Ø¡ˆ
        }
        else
        {
            if (Data != this) //instance∞° ≥ª∞° æ∆¥œ∂Û∏È ¿ÃπÃ instance∞° «œ≥™ ¡∏¿Á«œ∞Ì ¿÷¥Ÿ¥¬ ¿«πÃ
            {
                Destroy(this.gameObject); //µ— ¿ÃªÛ ¡∏¿Á«œ∏È æ»µ«¥¬ ∞¥√º¿Ã¥œ πÊ±› AWakeµ» ¿⁄Ω≈¿ª ªË¡¶
            }
        }
    }
    private void Start()
    {
        MappingKeys();
    }

    public Text edittext;

    public Dictionary<VirtualKeyCode, KeyData> DicKeyData;
    public bool isKorean;
    public bool isShift;
    public bool isCaps;
    public string completeStr = "";
    public string makeStr = "";


    #region Hangul
    public enum HANGUL_TYPE
    {
        CHO, JUNG, JONG
    }

    // √ º∫INDEX
    public char[] cho = {
          '§°', '§¢', '§§', '§ß', '§®',
          '§©', '§±', '§≤', '§≥', '§µ', '§∂',
          '§∑', '§∏', '§π', '§∫', '§ª', '§º', '§Ω', '§æ' };
    const int cho_count = 19;
    // ¡ﬂº∫INDEX
    public char[] jung = {
          '§ø', '§¿', '§¡', '§¬', '§√',
          '§ƒ', '§≈', '§∆', '§«', '§»', '§…',
          '§ ', '§À', '§Ã', '§Õ', '§Œ', '§œ',
          '§–', '§—', '§“', '§”'};
    const int jung_count = 21;
    // ¡æº∫INDEX
    public char[] jong = {
          ' ', '§°', '§¢', '§£', '§§', '§•', '§¶', '§ß', '§©',
          '§™', '§´', '§¨', '§≠', '§Æ', '§Ø', '§∞', '§±',
          '§≤', '§¥', '§µ', '§∂', '§∑', '§∏', '§∫', '§ª', '§º', '§Ω', '§æ'};
    const int jong_count = 28;
    // ¡∂«’INDEX
    public char[] JungComb = { '§»', '§…', '§ ', '§Õ', '§Œ', '§œ', '§“' };
    public string[] JungSplit = { "§«§ø", "§«§¿", "§«§”", "§Ã§√", "§Ã§ƒ", "§Ã§”", "§—§”" };
    public char[] JongComb = { '§£', '§•', '§¶', '§™', '§´', '§¨', '§≠', '§Æ', '§Ø', '§∞', '§¥' };
    public string[] JongSplit = { "§°§µ", "§§§∏", "§§§æ", "§©§°", "§©§±", "§©§≤", "§©§µ", "§©§º", "§©§Ω", "§©§æ", "§¥" };


    public const int BASE_MOD = 0xAC00;        // √≥¿Ω ∞™ (∞°)


    public const int START_WORD = 0xAC00;        // ¿Ωº∫π¸¿ß MIN(∞°)
    public const int LAST_WORD = 0xD7A3;        // ¿Ωº∫π¸¿ß MAX(∆R)

    public const int START_CHO = 0x1100;        // ¿Ωº∫π¸¿ß MIN(§°)
    public const int LAST_CHO = 0x1112;        // ¿Ωº∫π¸¿ß MAX(§æ)

    public const int START_JUNG = 0x1161;        // ¿Ωº∫π¸¿ß MIN(§ø)
    public const int LAST_JUNG = 0x1175;        // ¿Ωº∫π¸¿ß MAX(§”)

    public const int START_JONG = 0x11A8;        // ¿Ωº∫π¸¿ß MIN(§°)
    public const int LAST_JONG = 0x11C3;        // ¿Ωº∫π¸¿ß MAX(§æ)

    public int FindIndex(char _char, HANGUL_TYPE _type)
    {
        int index = 0;
        char[] hanguls = cho;
        switch (_type)
        {
            case HANGUL_TYPE.CHO:
                hanguls = cho;
                break;
            case HANGUL_TYPE.JUNG:
                hanguls = jung;
                break;
            case HANGUL_TYPE.JONG:
                hanguls = jong;
                break;
        }
        foreach (char element in hanguls)
        {
            if (element == _char)
            {
                return index;
            }
            ++index;
        }
        return -1;
    }
    public char FindChar(int index, HANGUL_TYPE _type)
    {
        char[] hanguls = cho;
        switch (_type)
        {
            case HANGUL_TYPE.CHO:
                hanguls = cho;
                break;
            case HANGUL_TYPE.JUNG:
                hanguls = jung;
                break;
            case HANGUL_TYPE.JONG:
                hanguls = jong;
                break;
        }
        return hanguls[index];
    }

    public char Combine_Hangul(char _cho, char _jung, char _jong = ' ')
    {
        return Convert.ToChar(BASE_MOD +
            FindIndex(_cho, HANGUL_TYPE.CHO) * jung_count * jong_count +
            FindIndex(_jung, HANGUL_TYPE.JUNG) * jong_count +
            FindIndex(_jong, HANGUL_TYPE.JONG));
    }
    public char Combine_Hangul_Jung(char _jungFirst, char _jungSecond)
    {
        int index = 0;
        foreach (string element in JungSplit)
        {
            if (element[0] == _jungFirst && element[1] == _jungSecond)
            {
                return JungComb[index];
            }
            ++index;
        }
        return ' ';
    }
    public char Combine_Hangul_Jong(char _jongFirst, char _jongSecond)
    {
        int index = 0;
        foreach (string element in JongSplit)
        {
            if (element[0] == _jongFirst && element[1] == _jongSecond)
            {
                return JongComb[index];
            }
            ++index;
        }
        return ' ';
    }

    public void Split_Hangul(char word, out char _cho, out char _jung, out char _jong)
    {
        int wordCode = Convert.ToInt32(word);
        wordCode -= BASE_MOD;
        int choCode = (wordCode / 28) / 21;
        _cho = cho[choCode];
        int jungCode = (wordCode / 28) % 21;
        _jung = jung[jungCode];
        int jongCode = wordCode % 28;
        _jong = jong[jongCode];
        return;
    }
    public bool Split_Hangul_Jung(char _jung, out char _jungFirst, out char _jungSecond)
    {
        int index = 0;
        foreach (char element in JungComb)
        {
            if (_jung == element) // ¡ﬂº∫ ∫–«ÿ ∞°¥… «‘
            {
                _jungFirst = JungSplit[index][0];
                _jungSecond = JungSplit[index][1];
                return true;
            }
            ++index;
        }
        // ¡ﬂº∫ ∫–«ÿ ∫“∞°¥…
        _jungFirst = _jung;
        _jungSecond = ' ';
        return false;
    }
    public bool Split_Hangul_Jong(char _jong, out char _jongFirst, out char _jongSecond)
    {
        int index = 0;
        foreach (char element in JongComb)
        {
            if (_jong == element) // ¡æº∫ ∫–«ÿ ∞°¥… «‘
            {
                _jongFirst = JongSplit[index][0];
                _jongSecond = JongSplit[index][1];
                return true;
            }
            ++index;
        }
        // ¡æº∫ ∫–«ÿ ∫“∞°¥…
        _jongFirst = _jong;
        _jongSecond = ' ';
        return false;
    }

    public void InputKRData(char _input)
    {
        // ¿‘∑¬¿∫ √ º∫∞˙ ¡ﬂº∫∏∏ ¿‘∑¬ ∞°¥…
        int ischo = FindIndex(_input, HANGUL_TYPE.CHO);
        int isjung = FindIndex(_input, HANGUL_TYPE.JUNG);
        if (ischo != -1)// √ º∫ ¿‘∑¬ ex) §°
        {
            if (makeStr == "") // æ∆π´ ¿‘∑¬¿Ã æ¯æ˙¿Ω
            {
                makeStr += _input;
                edittext.text = completeStr + makeStr; // ¿”Ω√
                return;
            }
            if (FindIndex(Convert.ToChar(makeStr), HANGUL_TYPE.CHO) != -1)
            {// ±‚¡∏ø° √ º∫¿Ã ¿÷¿Ω ex) §°  -> §°§°  ∂«¥¬ §£
                char result = Combine_Hangul_Jong(Convert.ToChar(makeStr), _input);
                if (result == ' ')
                { // «’º∫ ∫“∞°¥…
                    completeStr += makeStr;
                    edittext.text = completeStr;
                    makeStr = "";
                    makeStr += _input;
                    edittext.text = completeStr + makeStr; // ¿”Ω√
                    return;
                }
                else
                {
                    makeStr = "";
                    makeStr += result;
                    edittext.text = completeStr + makeStr; // ¿”Ω√
                    return;
                }
            }
            else if (FindIndex(Convert.ToChar(makeStr), HANGUL_TYPE.JUNG) != -1)
            {// ±‚¡∏ø° ¡ﬂº∫¿Ã ¿÷¿Ω ex) §ø -> §ø§°
                completeStr += makeStr;
                edittext.text = completeStr;
                makeStr = "";
                makeStr += _input;
                edittext.text = completeStr + makeStr; // ¿”Ω√
                return;
            }
            else if (FindIndex(Convert.ToChar(makeStr), HANGUL_TYPE.JONG) != -1)
            {// ±‚¡∏ø° ¡æº∫¿Ã ¿÷¿Ω ex) §£ -> §£§°  «’º∫ ∞°¥…«— ¡æº∫¿∫ √ º∫ ƒ…¿ÃΩ∫ø°º≠ ∞…∑Ø¡¸
                completeStr += makeStr;
                edittext.text = completeStr;
                makeStr = "";
                makeStr += _input;
                edittext.text = completeStr + makeStr; // ¿”Ω√
            }
            else
            {
                char _cho;
                char _jung;
                bool isjungSplit = false;
                char _jung1;// ¡ﬂº∫ ∫–«ÿ 1
                char _jung2;// ¡ﬂº∫ ∫–«ÿ 2
                char _jong;
                bool isjongSplit = false;
                char _jong1;// ¡æº∫ ∫–«ÿ 1
                char _jong2;// ¡æº∫ ∫–«ÿ 2
                Split_Hangul(Convert.ToChar(makeStr), out _cho, out _jung, out _jong);
                isjungSplit = Split_Hangul_Jung(_jung, out _jung1, out _jung2);
                isjongSplit = Split_Hangul_Jong(_jong, out _jong1, out _jong2);

                if (isjongSplit)
                {
                    // √ º∫ + ¡ﬂº∫ + <¡æº∫ + ¡æº∫> -> ex) ÅB -> ÅB§° (∫“∞°¥… «’º∫) -> ¡æº∫¿« ∫–«ÿ∞° ∞°¥…  isjongSplit = true
                    // √ º∫ + <¡ﬂº∫ + ¡ﬂº∫> + <¡æº∫ + ¡æº∫> -> ex) ÅÒ -> ÅÒ§° (∫“∞°¥… «’º∫) -> ¡æº∫¿« ∫–«ÿ∞° ∞°¥…  isjongSplit = true
                    completeStr += makeStr;
                    edittext.text = completeStr;
                    makeStr = "";
                    makeStr += _input;
                    edittext.text = completeStr + makeStr; // ¿”Ω√
                    return;
                }
                else
                {
                    if (_jong == ' ')
                    {
                        // √ º∫ + ¡ﬂº∫ -> ex) ∞° -> ∞¢ (π´¡∂∞« «’º∫)
                        // √ º∫ + ¡ﬂº∫ + ¡ﬂº∫ -> ex) ∞˙ -> ∞˚  (π´¡∂∞« «’º∫)
                        char result = Combine_Hangul(_cho, _jung, _input); // «’º∫
                        makeStr = "";
                        makeStr += result;
                        edittext.text = completeStr + makeStr; // ¿”Ω√
                        return;
                    }
                    // √ º∫ + ¡ﬂº∫ + ¡æº∫ -> ex) ∞¢ -> ∞¢§° ∂«¥¬ ÅB   (¡∂∞«∫Œ «’º∫) -> ¡æº∫¿« «’º∫ ∞°¥… ø©∫Œ »Æ¿Œ , isjongSplit = false
                    // √ º∫ + <¡ﬂº∫ + ¡ﬂº∫> + ¡æº∫ -> ex) ∞˚ -> ∞˚§°  ∂«¥¬ ÅÒ (¡∂∞«∫Œ «’º∫) -> ¡æº∫¿« «’º∫ ∞°¥… ø©∫Œ »Æ¿Œ , isjongSplit = false
                    char combineJong = Combine_Hangul_Jong(_jong, _input);
                    if (combineJong != ' ')
                    {// «’º∫ ∞°¥…
                        char result = Combine_Hangul(_cho, _jung, combineJong); // «’º∫
                        makeStr = "";
                        makeStr += result;
                        edittext.text = completeStr + makeStr; // ¿”Ω√
                        return;
                    }
                    else
                    {// «’º∫ ∫“∞°¥…
                        completeStr += makeStr;
                        edittext.text = completeStr;
                        makeStr = "";
                        makeStr += _input;
                        edittext.text = completeStr + makeStr; // ¿”Ω√
                        return;
                    }
                }
            }
        }
        if (isjung != -1)// ¡ﬂº∫ ¿‘∑¬
        {
            if (makeStr == "") // æ∆π´ ¿‘∑¬¿Ã æ¯æ˙¿Ω
            {
                makeStr += _input;
                edittext.text = completeStr + makeStr; // ¿”Ω√
                return;
            }
            if (FindIndex(Convert.ToChar(makeStr), HANGUL_TYPE.CHO) != -1)
            {// ±‚¡∏ø° √ º∫¿Ã ¿÷¿Ω ex) §°  -> ∞° (π´¡∂∞« «’º∫ ∞°¥…)
                char result = Combine_Hangul(Convert.ToChar(makeStr), _input);
                makeStr = "";
                makeStr += result;
                edittext.text = completeStr + makeStr; // ¿”Ω√
                return;
            }
            else if (FindIndex(Convert.ToChar(makeStr), HANGUL_TYPE.JUNG) != -1)
            {// ±‚¡∏ø° ¡ﬂº∫¿Ã ¿÷¿Ω ex) §ø -> §ø§ø  ∂«¥¬ §»
                char _jung = Convert.ToChar(makeStr);
                char result = Combine_Hangul_Jung(_jung, _input);
                if (result != ' ')
                {// «’º∫ ∞°¥…
                    makeStr = "";
                    makeStr += result;
                    edittext.text = completeStr + makeStr; // ¿”Ω√
                    return;
                }
                else
                {// «’º∫ ∫“∞°¥…
                    completeStr += makeStr;
                    edittext.text = completeStr;
                    makeStr = "";
                    makeStr += _input;
                    edittext.text = completeStr + makeStr; // ¿”Ω√
                    return;
                }
            }
            else if (FindIndex(Convert.ToChar(makeStr), HANGUL_TYPE.JONG) != -1)
            {// ±‚¡∏ø° ¡æº∫¿Ã ¿÷¿Ω ex) §£ -> §°ªÁ  ≥™∏”¡ˆ¥¬ √ º∫ ƒ…¿ÃΩ∫ø°º≠ ∞…∑Ø¡¸
                char _jong = Convert.ToChar(makeStr);
                bool isjongSplit = false;
                char _jong1;// ¡æº∫ ∫–«ÿ 1
                char _jong2;// ¡æº∫ ∫–«ÿ 2
                isjongSplit = Split_Hangul_Jong(_jong, out _jong1, out _jong2);
                if (isjongSplit)
                {
                    makeStr = "";
                    makeStr += _jong1;
                    completeStr += makeStr;
                    char result = Combine_Hangul(_jong2, _input);
                    makeStr = "";
                    makeStr += result;
                    edittext.text = completeStr + makeStr; // ¿”Ω√
                    return;
                }
            }
            else
            {
                char _cho;
                char _jung;
                bool isjungSplit = false;
                char _jung1;// ¡ﬂº∫ ∫–«ÿ 1
                char _jung2;// ¡ﬂº∫ ∫–«ÿ 2
                char _jong;
                bool isjongSplit = false;
                char _jong1;// ¡æº∫ ∫–«ÿ 1
                char _jong2;// ¡æº∫ ∫–«ÿ 2
                Split_Hangul(Convert.ToChar(makeStr), out _cho, out _jung, out _jong);
                isjungSplit = Split_Hangul_Jung(_jung, out _jung1, out _jung2);
                isjongSplit = Split_Hangul_Jong(_jong, out _jong1, out _jong2);

                if (isjongSplit)
                {
                    // √ º∫ + ¡ﬂº∫ + <¡æº∫ + ¡æº∫> -> ex) ÅB -> ∞¢ªÁ (π´¡∂∞« «’º∫ ∞°¥…) 
                    // √ º∫ + <¡ﬂº∫ + ¡ﬂº∫> + <¡æº∫ + ¡æº∫> -> ex) ÅÒ-> ∞˚ªÁ (π´¡∂∞« «’º∫ ∞°¥…) 
                    char result1 = Combine_Hangul(_cho, _jung, _jong1);
                    char result2 = Combine_Hangul(_jong2, _input);
                    completeStr += result1;
                    makeStr = "";
                    makeStr += result2;
                    edittext.text = completeStr + makeStr; // ¿”Ω√
                    return;
                }
                else
                {
                    if (_jong != ' ') // ¡æº∫¿Ã ¿÷¿Ω
                    {// √ º∫ + ¡ﬂº∫ + ¡æº∫ -> ex) ∞¢ -> ∞°∞° (π´¡∂∞« «’º∫ ∞°¥…) 
                        char result1 = Combine_Hangul(_cho, _jung);
                        char result2 = Combine_Hangul(_jong, _input);
                        completeStr += result1;
                        makeStr = "";
                        makeStr += result2;
                        edittext.text = completeStr + makeStr; // ¿”Ω√
                        return;
                    }
                    else
                    {
                        if (isjungSplit) // ¡ﬂº∫¿Ã ∫–«ÿ∞° µ«¥¬¡ˆ
                        {// √ º∫ + <¡ﬂº∫ + ¡ﬂº∫> -> ex) ∞˙ -> ∞˙§ø    (∫“∞°¥… «’º∫)
                            completeStr += makeStr;
                            edittext.text = completeStr;
                            makeStr = "";
                            makeStr += _input;
                            edittext.text = completeStr + makeStr; // ¿”Ω√
                        }
                        else
                        {// √ º∫ + ¡ﬂº∫ -> ex) ∞Ì -> ∞˙ ∂«¥¬ ∞Ì§«  (¡∂∞«∫Œ «’º∫)
                            char result = Combine_Hangul_Jung(_jung, _input);
                            if (result != ' ')
                            {// «’º∫ ∞°¥…
                                char combine = Combine_Hangul(_cho, result);
                                makeStr = "";
                                makeStr += combine;
                                edittext.text = completeStr + makeStr; // ¿”Ω√
                                return;
                            }
                            else
                            {// «’º∫ ∫“∞°¥…
                                completeStr += makeStr;
                                edittext.text = completeStr;
                                makeStr = "";
                                makeStr += _input;
                                edittext.text = completeStr + makeStr; // ¿”Ω√
                                return;
                            }
                        }
                    }
                }
            }
        }
    }
    #endregion

    public void DeleteData()
    {
        if (makeStr == "") // æ≤¥¯ πÆ¿⁄∞° æ¯¿ª∂ß
        {
            if (completeStr != null)
            {
                if (completeStr.Length > 0)
                {
                    int n = completeStr.LastIndexOf("\n");
                    if (n == -1)
                    {
                        completeStr = completeStr.Remove(completeStr.Length - 1);
                        edittext.text = completeStr;
                        return;
                    }
                    else
                    {
                        completeStr = completeStr.Remove(completeStr.Length - 2);
                        edittext.text = completeStr;
                        return;
                    }
                }
            }
        }
        else
        {
            if (FindIndex(Convert.ToChar(makeStr), HANGUL_TYPE.CHO) != -1)// √ º∫
            {
                makeStr = "";
                edittext.text = completeStr + makeStr;
                return;
            }
            else if (FindIndex(Convert.ToChar(makeStr), HANGUL_TYPE.JUNG) != -1)// ¡ﬂº∫
            {
                char jung1;
                char jung2;
                if (Split_Hangul_Jung(Convert.ToChar(makeStr), out jung1, out jung2))
                {// ∫–«ÿ º∫∞¯
                    makeStr = "";
                    makeStr += jung1;
                    edittext.text = completeStr + makeStr;
                    return;
                }
                else
                {//∫–«ÿ æ»µ 
                    makeStr = "";
                    edittext.text = completeStr + makeStr;
                }
            }
            else if (FindIndex(Convert.ToChar(makeStr), HANGUL_TYPE.JONG) != -1) // ¡æº∫
            {
                char jong1;
                char jong2;
                if (Split_Hangul_Jong(Convert.ToChar(makeStr), out jong1, out jong2))
                {// ∫–«ÿ º∫∞¯
                    makeStr = "";
                    makeStr += jong1;
                    edittext.text = completeStr + makeStr;
                    return;
                }
                else
                {//∫–«ÿ æ»µ 
                    makeStr = "";
                    edittext.text = completeStr + makeStr;
                    return;
                }
            }
            else
            {
                char _cho;
                char _jung;
                bool isjungSplit = false;
                char _jung1;// ¡ﬂº∫ ∫–«ÿ 1
                char _jung2;// ¡ﬂº∫ ∫–«ÿ 2
                char _jong;
                bool isjongSplit = false;
                char _jong1;// ¡æº∫ ∫–«ÿ 1
                char _jong2;// ¡æº∫ ∫–«ÿ 2
                Split_Hangul(Convert.ToChar(makeStr), out _cho, out _jung, out _jong);
                isjungSplit = Split_Hangul_Jung(_jung, out _jung1, out _jung2);
                isjongSplit = Split_Hangul_Jong(_jong, out _jong1, out _jong2);

                if (_jong != ' ') // ¡æº∫ ø©∫Œ
                {
                    if (isjongSplit) // ¡æº∫ ∫–«ÿ ø©∫Œ
                    {//ÅB -> ∞¢
                        makeStr = "";
                        makeStr += Combine_Hangul(_cho, _jung, _jong1);
                        edittext.text = completeStr + makeStr;
                        return;
                    }
                    else
                    {//∞¢ -> ∞°
                        makeStr = "";
                        makeStr += Combine_Hangul(_cho, _jung);
                        edittext.text = completeStr + makeStr;
                        return;
                    }
                }
                else
                {
                    if (isjungSplit)// ¡ﬂº∫ ∫–«ÿ ø©∫Œ
                    {//∞˙ -> ∞Ì
                        makeStr = "";
                        makeStr += Combine_Hangul(_cho, _jung1);
                        edittext.text = completeStr + makeStr;
                        return;
                    }
                    else
                    {// ∞Ì -> §°
                        makeStr = "";
                        makeStr += _cho;
                        edittext.text = completeStr + makeStr;
                        return;
                    }
                }
            }
        }
    }

    public void SpaceData()
    {
        if (makeStr == "") // æ≤¥¯ πÆ¿⁄∞° æ¯¿ª∂ß
        {
            completeStr += " ";
            edittext.text = completeStr;
        }
        else
        {
            completeStr += makeStr;
            completeStr += " ";
            makeStr = "";
            edittext.text = completeStr;
        }
    }

    #region Private Method
    private void MappingKeys()
    {
        DicKeyData = new Dictionary<VirtualKeyCode, KeyData>();
        DicKeyData.Add(VirtualKeyCode.VK_1, new KeyData { DefaultKey = '1', ShiftKey = '!' });
        DicKeyData.Add(VirtualKeyCode.VK_2, new KeyData { DefaultKey = '2', ShiftKey = '@' });
        DicKeyData.Add(VirtualKeyCode.VK_3, new KeyData { DefaultKey = '3', ShiftKey = '#' });
        DicKeyData.Add(VirtualKeyCode.VK_4, new KeyData { DefaultKey = '4', ShiftKey = '$' });
        DicKeyData.Add(VirtualKeyCode.VK_5, new KeyData { DefaultKey = '5', ShiftKey = '%' });
        DicKeyData.Add(VirtualKeyCode.VK_6, new KeyData { DefaultKey = '6', ShiftKey = '^' });
        DicKeyData.Add(VirtualKeyCode.VK_7, new KeyData { DefaultKey = '7', ShiftKey = '&' });
        DicKeyData.Add(VirtualKeyCode.VK_8, new KeyData { DefaultKey = '8', ShiftKey = '*' });
        DicKeyData.Add(VirtualKeyCode.VK_9, new KeyData { DefaultKey = '9', ShiftKey = '(' });
        DicKeyData.Add(VirtualKeyCode.VK_0, new KeyData { DefaultKey = '0', ShiftKey = ')' });

        DicKeyData.Add(VirtualKeyCode.VK_A, new KeyData { DefaultKey = 'a', KorKey = '§±' });
        DicKeyData.Add(VirtualKeyCode.VK_B, new KeyData { DefaultKey = 'b', KorKey = '§–' });
        DicKeyData.Add(VirtualKeyCode.VK_C, new KeyData { DefaultKey = 'c', KorKey = '§∫' });
        DicKeyData.Add(VirtualKeyCode.VK_D, new KeyData { DefaultKey = 'd', KorKey = '§∑' });
        DicKeyData.Add(VirtualKeyCode.VK_E, new KeyData { DefaultKey = 'e', KorKey = '§ß', KorShiftKey = '§®' });
        DicKeyData.Add(VirtualKeyCode.VK_F, new KeyData { DefaultKey = 'f', KorKey = '§©' });
        DicKeyData.Add(VirtualKeyCode.VK_G, new KeyData { DefaultKey = 'g', KorKey = '§æ' });
        DicKeyData.Add(VirtualKeyCode.VK_H, new KeyData { DefaultKey = 'h', KorKey = '§«' });
        DicKeyData.Add(VirtualKeyCode.VK_I, new KeyData { DefaultKey = 'i', KorKey = '§¡' });
        DicKeyData.Add(VirtualKeyCode.VK_J, new KeyData { DefaultKey = 'j', KorKey = '§√' });
        DicKeyData.Add(VirtualKeyCode.VK_K, new KeyData { DefaultKey = 'k', KorKey = '§ø' });
        DicKeyData.Add(VirtualKeyCode.VK_L, new KeyData { DefaultKey = 'l', KorKey = '§”' });
        DicKeyData.Add(VirtualKeyCode.VK_M, new KeyData { DefaultKey = 'm', KorKey = '§—' });
        DicKeyData.Add(VirtualKeyCode.VK_N, new KeyData { DefaultKey = 'n', KorKey = '§Ã' });
        DicKeyData.Add(VirtualKeyCode.VK_O, new KeyData { DefaultKey = 'o', KorKey = '§¿', KorShiftKey = '§¬' });
        DicKeyData.Add(VirtualKeyCode.VK_P, new KeyData { DefaultKey = 'p', KorKey = '§ƒ', KorShiftKey = '§∆' });
        DicKeyData.Add(VirtualKeyCode.VK_Q, new KeyData { DefaultKey = 'q', KorKey = '§≤', KorShiftKey = '§≥' });
        DicKeyData.Add(VirtualKeyCode.VK_R, new KeyData { DefaultKey = 'r', KorKey = '§°', KorShiftKey = '§¢' });
        DicKeyData.Add(VirtualKeyCode.VK_S, new KeyData { DefaultKey = 's', KorKey = '§§' });
        DicKeyData.Add(VirtualKeyCode.VK_T, new KeyData { DefaultKey = 't', KorKey = '§µ', KorShiftKey = '§∂' });
        DicKeyData.Add(VirtualKeyCode.VK_U, new KeyData { DefaultKey = 'u', KorKey = '§≈' });
        DicKeyData.Add(VirtualKeyCode.VK_V, new KeyData { DefaultKey = 'v', KorKey = '§Ω' });
        DicKeyData.Add(VirtualKeyCode.VK_W, new KeyData { DefaultKey = 'w', KorKey = '§∏', KorShiftKey = '§π' });
        DicKeyData.Add(VirtualKeyCode.VK_X, new KeyData { DefaultKey = 'x', KorKey = '§º' });
        DicKeyData.Add(VirtualKeyCode.VK_Y, new KeyData { DefaultKey = 'y', KorKey = '§À' });
        DicKeyData.Add(VirtualKeyCode.VK_Z, new KeyData { DefaultKey = 'z', KorKey = '§ª' });

        DicKeyData.Add(VirtualKeyCode.OEM_3, new KeyData { DefaultKey = '`', ShiftKey = '~' });
        DicKeyData.Add(VirtualKeyCode.OEM_MINUS, new KeyData { DefaultKey = '-', ShiftKey = '_' });
        DicKeyData.Add(VirtualKeyCode.OEM_PLUS, new KeyData { DefaultKey = '=', ShiftKey = '+' });
        DicKeyData.Add(VirtualKeyCode.BACK, new KeyData { DefaultKey = ' ' });
        DicKeyData.Add(VirtualKeyCode.TAB, new KeyData { DefaultKey = ' ' });
        DicKeyData.Add(VirtualKeyCode.OEM_4, new KeyData { DefaultKey = '[', ShiftKey = '{' });
        DicKeyData.Add(VirtualKeyCode.OEM_6, new KeyData { DefaultKey = ']', ShiftKey = '}' });
        DicKeyData.Add(VirtualKeyCode.OEM_5, new KeyData { DefaultKey = '£‹', ShiftKey = '|' });
        DicKeyData.Add(VirtualKeyCode.CAPITAL, new KeyData { DefaultKey = ' ' });
        DicKeyData.Add(VirtualKeyCode.OEM_1, new KeyData { DefaultKey = ';', ShiftKey = ':' });
        DicKeyData.Add(VirtualKeyCode.OEM_7, new KeyData { DefaultKey = '\'', ShiftKey = '\"' });
        DicKeyData.Add(VirtualKeyCode.RETURN, new KeyData { DefaultKey = ' ' });
        DicKeyData.Add(VirtualKeyCode.SHIFT, new KeyData { DefaultKey = ' ' });
        DicKeyData.Add(VirtualKeyCode.OEM_COMMA, new KeyData { DefaultKey = ',', ShiftKey = '<' });
        DicKeyData.Add(VirtualKeyCode.OEM_PERIOD, new KeyData { DefaultKey = '.', ShiftKey = '>' });
        DicKeyData.Add(VirtualKeyCode.OEM_2, new KeyData { DefaultKey = '/', ShiftKey = '?' });
        DicKeyData.Add(VirtualKeyCode.HANGUL, new KeyData { DefaultKey = ' ' });
        DicKeyData.Add(VirtualKeyCode.SPACE, new KeyData { DefaultKey = ' ' });
    }
    #endregion


}


public enum VirtualKeyCode
{
    //NumKey
    VK_1,
    VK_2,
    VK_3,
    VK_4,
    VK_5,
    VK_6,
    VK_7,
    VK_8,
    VK_9,
    VK_0,
    //CharKey
    VK_A,
    VK_B,
    VK_C,
    VK_D,
    VK_E,
    VK_F,
    VK_G,
    VK_H,
    VK_I,
    VK_J,
    VK_K,
    VK_L,
    VK_M,
    VK_N,
    VK_O,
    VK_P,
    VK_Q,
    VK_R,
    VK_S,
    VK_T,
    VK_U,
    VK_V,
    VK_W,
    VK_X,
    VK_Y,
    VK_Z,
    //
    OEM_3,
    OEM_MINUS,
    OEM_PLUS,
    BACK, TAB,
    OEM_4,
    OEM_6,
    OEM_5,
    CAPITAL,
    OEM_1,
    OEM_7,
    RETURN,
    SHIFT,
    OEM_COMMA,
    OEM_PERIOD,
    OEM_2,
    HANGUL,
    SPACE
}


//_dicKeyData.Add(VirtualKeyCode.VK_1, new KeyData { DefaultKey = "1", ShiftKey = "!" });
//_dicKeyData.Add(VirtualKeyCode.VK_2, new KeyData { DefaultKey = "2", ShiftKey = "@" });
//_dicKeyData.Add(VirtualKeyCode.VK_3, new KeyData { DefaultKey = "3", ShiftKey = "#" });
//_dicKeyData.Add(VirtualKeyCode.VK_4, new KeyData { DefaultKey = "4", ShiftKey = "$" });
//_dicKeyData.Add(VirtualKeyCode.VK_5, new KeyData { DefaultKey = "5", ShiftKey = "%" });
//_dicKeyData.Add(VirtualKeyCode.VK_6, new KeyData { DefaultKey = "6", ShiftKey = "^" });
//_dicKeyData.Add(VirtualKeyCode.VK_7, new KeyData { DefaultKey = "7", ShiftKey = "&" });
//_dicKeyData.Add(VirtualKeyCode.VK_8, new KeyData { DefaultKey = "8", ShiftKey = "*" });
//_dicKeyData.Add(VirtualKeyCode.VK_9, new KeyData { DefaultKey = "9", ShiftKey = "(" });
//_dicKeyData.Add(VirtualKeyCode.VK_0, new KeyData { DefaultKey = "0", ShiftKey = ")" });

//_dicKeyData.Add(VirtualKeyCode.VK_A, new KeyData { DefaultKey = "a", KorKey = "§±" });
//_dicKeyData.Add(VirtualKeyCode.VK_B, new KeyData { DefaultKey = "b", KorKey = "§–" });
//_dicKeyData.Add(VirtualKeyCode.VK_C, new KeyData { DefaultKey = "c", KorKey = "§∫" });
//_dicKeyData.Add(VirtualKeyCode.VK_D, new KeyData { DefaultKey = "d", KorKey = "§∑" });
//_dicKeyData.Add(VirtualKeyCode.VK_E, new KeyData { DefaultKey = "e", KorKey = "§ß", KorShiftKey = "§®" });
//_dicKeyData.Add(VirtualKeyCode.VK_F, new KeyData { DefaultKey = "f", KorKey = "§©" });
//_dicKeyData.Add(VirtualKeyCode.VK_G, new KeyData { DefaultKey = "g", KorKey = "§æ" });
//_dicKeyData.Add(VirtualKeyCode.VK_H, new KeyData { DefaultKey = "h", KorKey = "§«" });
//_dicKeyData.Add(VirtualKeyCode.VK_I, new KeyData { DefaultKey = "i", KorKey = "§¡" });
//_dicKeyData.Add(VirtualKeyCode.VK_J, new KeyData { DefaultKey = "j", KorKey = "§√" });
//_dicKeyData.Add(VirtualKeyCode.VK_K, new KeyData { DefaultKey = "k", KorKey = "§ø" });
//_dicKeyData.Add(VirtualKeyCode.VK_L, new KeyData { DefaultKey = "l", KorKey = "§”" });
//_dicKeyData.Add(VirtualKeyCode.VK_M, new KeyData { DefaultKey = "m", KorKey = "§—" });
//_dicKeyData.Add(VirtualKeyCode.VK_N, new KeyData { DefaultKey = "n", KorKey = "§Ã" });
//_dicKeyData.Add(VirtualKeyCode.VK_O, new KeyData { DefaultKey = "o", KorKey = "§¿", KorShiftKey = "§¬" });
//_dicKeyData.Add(VirtualKeyCode.VK_P, new KeyData { DefaultKey = "p", KorKey = "§ƒ", KorShiftKey = "§∆" });
//_dicKeyData.Add(VirtualKeyCode.VK_Q, new KeyData { DefaultKey = "q", KorKey = "§≤", KorShiftKey = "§≥" });
//_dicKeyData.Add(VirtualKeyCode.VK_R, new KeyData { DefaultKey = "r", KorKey = "§°", KorShiftKey = "§¢" });
//_dicKeyData.Add(VirtualKeyCode.VK_S, new KeyData { DefaultKey = "s", KorKey = "§§" });
//_dicKeyData.Add(VirtualKeyCode.VK_T, new KeyData { DefaultKey = "t", KorKey = "§µ", KorShiftKey = "§∂" });
//_dicKeyData.Add(VirtualKeyCode.VK_U, new KeyData { DefaultKey = "u", KorKey = "§≈" });
//_dicKeyData.Add(VirtualKeyCode.VK_V, new KeyData { DefaultKey = "v", KorKey = "§Ω" });
//_dicKeyData.Add(VirtualKeyCode.VK_W, new KeyData { DefaultKey = "w", KorKey = "§∏", KorShiftKey = "§π" });
//_dicKeyData.Add(VirtualKeyCode.VK_X, new KeyData { DefaultKey = "x", KorKey = "§º" });
//_dicKeyData.Add(VirtualKeyCode.VK_Y, new KeyData { DefaultKey = "y", KorKey = "§À" });
//_dicKeyData.Add(VirtualKeyCode.VK_Z, new KeyData { DefaultKey = "z", KorKey = "§ª" });

//_dicKeyData.Add(VirtualKeyCode.OEM_3, new KeyData { DefaultKey = "`", ShiftKey = "~" });
//_dicKeyData.Add(VirtualKeyCode.OEM_MINUS, new KeyData { DefaultKey = "-", ShiftKey = "_" });
//_dicKeyData.Add(VirtualKeyCode.OEM_PLUS, new KeyData { DefaultKey = "=", ShiftKey = "+" });
//_dicKeyData.Add(VirtualKeyCode.BACK, new KeyData { DefaultKey = "Backspace" });
//_dicKeyData.Add(VirtualKeyCode.TAB, new KeyData { DefaultKey = "Tab" });
//_dicKeyData.Add(VirtualKeyCode.OEM_4, new KeyData { DefaultKey = "[", ShiftKey = "{" });
//_dicKeyData.Add(VirtualKeyCode.OEM_6, new KeyData { DefaultKey = "]", ShiftKey = "}" });
//_dicKeyData.Add(VirtualKeyCode.OEM_5, new KeyData { DefaultKey = "£‹", ShiftKey = "|" });
//_dicKeyData.Add(VirtualKeyCode.CAPITAL, new KeyData { DefaultKey = "Caps Lock" });
//_dicKeyData.Add(VirtualKeyCode.OEM_1, new KeyData { DefaultKey = ";", ShiftKey = ":" });
//_dicKeyData.Add(VirtualKeyCode.OEM_7, new KeyData { DefaultKey = "'", ShiftKey = "°»" });
//_dicKeyData.Add(VirtualKeyCode.RETURN, new KeyData { DefaultKey = "Enter" });
//_dicKeyData.Add(VirtualKeyCode.SHIFT, new KeyData { DefaultKey = "Shift" });
//_dicKeyData.Add(VirtualKeyCode.OEM_COMMA, new KeyData { DefaultKey = ",", ShiftKey = "<" });
//_dicKeyData.Add(VirtualKeyCode.OEM_PERIOD, new KeyData { DefaultKey = ".", ShiftKey = ">" });
//_dicKeyData.Add(VirtualKeyCode.OEM_2, new KeyData { DefaultKey = "/", ShiftKey = "?" });
//_dicKeyData.Add(VirtualKeyCode.HANGUL, new KeyData { DefaultKey = "«—/øµ" });
//_dicKeyData.Add(VirtualKeyCode.SPACE, new KeyData { DefaultKey = "Space" });

//_dicKeyData.Add(VirtualKeyCode.NUMPAD0, new KeyData { DefaultKey = "0" });
//_dicKeyData.Add(VirtualKeyCode.NUMPAD1, new KeyData { DefaultKey = "1" });
//_dicKeyData.Add(VirtualKeyCode.NUMPAD2, new KeyData { DefaultKey = "2" });
//_dicKeyData.Add(VirtualKeyCode.NUMPAD3, new KeyData { DefaultKey = "3" });
//_dicKeyData.Add(VirtualKeyCode.NUMPAD4, new KeyData { DefaultKey = "4" });
//_dicKeyData.Add(VirtualKeyCode.NUMPAD5, new KeyData { DefaultKey = "5" });
//_dicKeyData.Add(VirtualKeyCode.NUMPAD6, new KeyData { DefaultKey = "6" });
//_dicKeyData.Add(VirtualKeyCode.NUMPAD7, new KeyData { DefaultKey = "7" });
//_dicKeyData.Add(VirtualKeyCode.NUMPAD8, new KeyData { DefaultKey = "8" });
//_dicKeyData.Add(VirtualKeyCode.NUMPAD9, new KeyData { DefaultKey = "9" });